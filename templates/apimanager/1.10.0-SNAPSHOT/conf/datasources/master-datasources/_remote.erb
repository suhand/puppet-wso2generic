<%- if @amtype == 'gateway' or @amtype == 'keymanager' or @amtype == 'publisher' or @amtype == 'apistore' or @amtype == 'pubstore' -%>
        <datasource>
            <name>WSO2AM_DB</name>
            <description>The datasource used for the API Manager database</description>
            <jndiConfig>
                <name>jdbc/WSO2AM_DB</name>
            </jndiConfig>
            <definition type="RDBMS">
                <configuration>
                    <url><%= @apim_db_connection_url %></url>
                    <username><%= @apim_db_user %></username>
                    <password><%= @apim_db_password %></password>
                    <defaultAutoCommit>false</defaultAutoCommit>
                    <driverClassName><%= @apim_db_driver_name %></driverClassName>
                    <maxActive>50</maxActive>
                    <maxWait>60000</maxWait>
                    <testOnBorrow>true</testOnBorrow>
                    <validationQuery>SELECT 1</validationQuery>
                    <validationInterval>30000</validationInterval>
                </configuration>
            </definition>
        </datasource>
<%- end -%>

<%- if @amtype == 'gateway' or  @amtype == 'keymanager' or @amtype == 'publisher' or @amtype == 'apistore' or @amtype == 'pubstore' -%>
	<datasource>
            <name>WSO2UM_DB</name>
            <description>The datasource used by user manager</description>
            <jndiConfig>
                <name>jdbc/WSO2UM_DB</name>
            </jndiConfig>
            <definition type="RDBMS">
                <configuration>
                    <url><%= @userstore_db_connection_url %></url>
                    <username><%= @userstore_db_user %></username>
                    <password><%= @userstore_db_password %></password>
                    <driverClassName><%= @userstore_db_driver_name %></driverClassName>
                    <maxActive>50</maxActive>
                    <maxWait>60000</maxWait>
                    <testOnBorrow>true</testOnBorrow>
                    <validationQuery>SELECT 1</validationQuery>
                    <validationInterval>30000</validationInterval>
                </configuration>
            </definition>
        </datasource>
<%- end -%>

<%- if @amtype == 'publisher' or @amtype == 'apistore' or @amtype == 'pubstore' or @amtype== 'gateway' -%>
        <datasource>
            <name>WSO2REG_DB</name>
            <description>The datasource used by the registry</description>
            <jndiConfig>
                <name>jdbc/WSO2REG_DB</name>
            </jndiConfig>
            <definition type="RDBMS">
                <configuration>
                    <url><%= @registry_db_connection_url %></url>
                    <username><%= @registry_db_user %></username>
                    <password><%= @registry_db_password %></password>
                    <driverClassName><%= @registry_db_driver_name %></driverClassName>
                    <maxActive>50</maxActive>
                    <maxWait>60000</maxWait>
                    <testOnBorrow>true</testOnBorrow>
                    <validationQuery>SELECT 1</validationQuery>
                    <validationInterval>30000</validationInterval>
                </configuration>
            </definition>
        </datasource>
<%- end -%>

<%- if @amtype == 'publisher' or @amtype == 'apistore' or @amtype == 'pubstore' -%>
        <datasource>
            <name>WSO2AM_STATS_DB</name>
            <description>The datasource used for getting statistics to API Manager</description>
            <jndiConfig>
                <name>jdbc/WSO2AM_STATS_DB</name>
            </jndiConfig>
            <definition type="RDBMS">
                <configuration>
                    <url><%= @stats_db_connection_url %></url>
                    <username><%= @stats_db_user %></username>
                    <password><%= @stats_db_password %></password>
                    <defaultAutoCommit>false</defaultAutoCommit>
                    <driverClassName><%= @stats_db_driver_name %></driverClassName>
                    <maxActive>50</maxActive>
                    <maxWait>60000</maxWait>
                    <testOnBorrow>true</testOnBorrow>
                    <validationQuery>SELECT 1</validationQuery>
                    <validationInterval>30000</validationInterval>
                </configuration>
            </definition>
        </datasource>
<%- end -%>
